"0",""
"0","## Include only countries with reductions in all three metrics"
"0",""
"0","inclusions <- data_totals %>% "
"0","  filter(!is.na(rate)) %>% "
"0","  group_by(country,iso,var) %>% "
"0","  summarise(rate=last(rate)) %>%"
"0","  mutate(include=ifelse(rate<0,1,0))"
"0",""
"0",""
"0","## check if countries with earlier peak years also reduced in the past 10 years"
"0",""
"0","rates <- data_totals %>% filter(country==""nothing"")"
"0",""
"0","for (i in 1:length(unique(data_totals$country))) {"
"0","  "
"0","  temp_data <- data_totals %>% filter(country==unique(data_totals$country)[i])"
"0","  temp_data <- temp_data %>% "
"0","    group_by(var) %>% "
"0","    filter(year>=max(data_totals$year)-9)"
"0","  "
"0","  ## Exclusions"
"0","  temp_data <- temp_data %>% "
"0","    filter(!is.na(value)) %>% "
"0","    filter(include==0)"
"0","  "
"0","  ## Calculations"
"0","  temp_data <- temp_data %>% "
"0","    group_by(var) %>% "
"0","    mutate(rate=growth_rate(year,value)$rate) %>% "
"0","    mutate(fit=growth_rate(year,value)$data$predicted_x)"
"0","  "
"0","  rates <- rbind(rates,temp_data)"
"0","}"
"0",""
"0","rates <- rates %>% "
"0","  select(country,iso,var,rate) %>% "
"0","  distinct() %>% "
"0","  mutate(include=ifelse(rate<0,1,0)) %>% "
"0","  mutate(var=paste0(var,""_10yr""))"
"0",""
"0","inclusions <- inclusions %>% "
"0","  rbind(.,rates)"
"0"," "
"0","## Make a strict inclusion criteria where all 6 indicators need to be negative"
"0",""
"0","inclusions <- inclusions %>% "
"0","  group_by(iso) %>% "
"0","  mutate(strict_include=sum(include)) %>% "
"0","  arrange(iso)"
"0",""
"0","## Make a less strict criteria with exceptions for countries with declining land sinks in the past 10 years"
"0","inclusions <- inclusions %>%"
"0","  left_join(.,inclusions %>% filter(strict_include>=5 & var==""value_inLUC_10yr"" & include==0 | "
"0","                                      strict_include>=5 & var==""value_co2cons_10yr"" & include==0) %>% "
"0","              mutate(less_strict_include=""yes"") %>% "
"0","              select(iso,less_strict_include))"
"0",""
"0","## Tidy up"
"0","inclusions <- inclusions %>% "
"0","  mutate(less_strict_include=ifelse(strict_include==6,""yes"",less_strict_include)) %>% "
"0","  mutate(less_strict_include=ifelse(is.na(less_strict_include)==TRUE,""no"",less_strict_include)) %>% "
"0","  mutate(strict_include=ifelse(strict_include==6,""yes"",""no""))"
"0",""
"0","inclusions <- inclusions %>% "
"0","  select(iso,country,strict_include,less_strict_include) %>% "
"0","  distinct()"
"0",""
"0","length(inclusions$country[inclusions$strict_include==""yes""])"
"1","[1]"
"1"," 22"
"1","
"
"0","length(inclusions$country[inclusions$less_strict_include==""yes""])"
"1","[1]"
"1"," 28"
"1","
"
"0"," "
"0","write.xlsx(inclusions,""inclusions.xlsx"")"
"0",""
"0",""
