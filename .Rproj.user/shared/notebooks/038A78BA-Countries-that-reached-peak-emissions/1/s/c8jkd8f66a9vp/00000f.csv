"0",""
"0","countries = data_totals %>% "
"0","  filter(year==2022) %>% "
"0","  filter(rate<0) %>% "
"0","  select(country) %>% "
"0","  distinct()"
"2","Adding missing grouping variables: `iso`, `var`"
"0","countries <- countries$country"
"0","i=1"
"0",""
"0","data_totals$var <- as.factor(data_totals$var)"
"0","data_totals$var <- fct_relevel(data_totals$var,""value_exLUC"",""value_inLUC"",""value_co2cons"")"
"0",""
"0",""
"0",""
"0","## Create sequence in 5 year intervals for plotting dots"
"0",""
"0","year_higlight <- seq(1990, max(data_totals$year), by = 5)"
"0",""
"0","if (!max(data_totals$year) %in% year_higlight) {"
"0","  year_higlight <- c(year_higlight, max(data_totals$year))"
"0","}"
"0",""
"0",""
"0","for (i in 1:length(countries)) {"
"0","  "
"0","  plot_data <- data_totals %>% "
"0","    ungroup() %>% "
"0","    filter(country == countries[i])"
"0","  "
"0","  plot_labels <- plot_data %>% "
"0","    filter(!is.na(value)) %>% "
"0","    group_by(var) %>% "
"0","    summarise(value=last(value),rate=round(last(rate)*100,1),peak_year=last(peak_year)) %>% "
"0","    mutate(label=ifelse(var==""value_exLUC"",paste0(""Total GHG emissions excl. land use change: "",rate,""%/yr since "",peak_year),"
"0","                        NA)) %>% "
"0","    mutate(label=ifelse(var==""value_inLUC"",paste0(""Total GHG emissions incl. land use change: "",rate,""%/yr since "",peak_year),"
"0","                        label)) %>% "
"0","    mutate(label=ifelse(var==""value_co2cons"",paste0(""Consumption-based CO2 emissions: "",rate,""%/yr since "",peak_year),"
"0","                        label))"
"0","  "
"0","  "
"0","  p1 <- plot_data %>% "
"0","    ggplot(.,aes(x=year,y=value,color=var)) +"
"0","    geom_path(size=1,alpha=0.5) +"
"0","    geom_point(data=plot_data %>% "
"0","                 filter(year %in% year_higlight),"
"0","               shape=21,fill=""white"") +"
"0","    geom_path(aes(x=year,y=fit,color=var),size=1) +"
"0","    theme_wl_bar_trend() + "
"0","    scale_x_continuous(limits=c(1989,max(data_totals$year)+1),"
"0","                       expand = expansion(mult = c(0.01, 0.01)),"
"0","                       breaks=c(1990,2000,2010,max(data_totals$year))) +"
"0","    scale_y_continuous(limits = c(0, NA)) +"
"0","    scale_colour_manual(values=c(""#659cccff"",""#7dd396ff"",""#d45087ff"")) +"
"0","    theme(axis.title = element_blank(),legend.position = ""none"") +"
"0","    labs(title=paste0(countries[i]),"
"0","         subtitle=expression(""MtCO""[2]*""e/yr""),"
"0","         caption=""⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb  \n⌂ Note: GWP100 AR6; net land use change (LULUCF) emissions based on inventories"")"
"0","  "
"0","  "
"0","  p2 <- plot_labels %>% "
"0","    ggplot(.,aes(x=1,y=value,label=str_wrap(label,30),colour=var)) +"
"0","    geom_text_repel("
"0","      nudge_x = 4,"
"0","      direction = ""y"","
"0","      hjust = 0,"
"0","      size= 3.75,"
"0","      min.segment.length = Inf,"
"0","      box.padding = 0.35) +"
"0","    theme_wl_empty() +"
"0","    scale_y_continuous(limits = c(0,layer_scales(p1)$y$range$range[2])) +"
"0","    scale_x_continuous(expand = expansion(mult = c(0, 0.01))) +"
"0","    scale_colour_manual(values=c(""#659cccff"",""#7dd396ff"",""#d45087ff"")) +"
"0","    theme(plot.margin = unit(c(0,0,0,0),""cm""),"
"0","          legend.position=""none"")"
"0","  "
"0","  "
"0","  p <- p1 + p2 + plot_layout(widths = c(4,2.1))"
"0","  p"
"0","  "
"0","  ggsave(paste0(""results/countries/"",countries[i],""-trend.png""), plot = p, device = ""png"", dpi = 300, width = 7, height = 4)"
"0","  ggsave(paste0(""results/countries/"",countries[i],""-trend.pdf""), plot = p, device = cairo_pdf, width = 7, height = 4)"
"0","  ggsave(paste0(""results/countries/"",countries[i],""-trend.svg""), plot = p, device = ""svg"", width = 7, height = 4)"
"0","  "
"0","  "
"0","}"
"2","Warnung: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
Please use `linewidth` instead."
"2","Warnung: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
Please use the `linewidth` argument instead."
