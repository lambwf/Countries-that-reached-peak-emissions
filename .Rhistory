write.xlsx(inclusions,"inclusions.xlsx")
inclusions <- inclusions %>% arrange(iso)
write.xlsx(inclusions,"inclusions.xlsx")
filenames <- read.xlsx("inclusions.xlsx")
View(filenames)
filenames <- read.xlsx("inclusions.xlsx") %>%
filter(strict_include==6) %>%
distinct() %>%
mutate(files=row_number()) %>%
mutate(files=ifelse(files==1,paste0("results/countries/",country,"-trend.svg"),paste0("results/countries/",country,"-change.svg")))
filenames <- read.xlsx("inclusions.xlsx") %>%
select(iso,strict_include) %>%
filter(strict_include==6) %>%
distinct() %>%
mutate(files=row_number()) %>%
mutate(files=ifelse(files==1,paste0("results/countries/",country,"-trend.svg"),paste0("results/countries/",country,"-change.svg")))
filenames <- read.xlsx("inclusions.xlsx") %>%
select(iso,strict_include) %>%
filter(strict_include==6) %>%
distinct() %>%
group_by(country) %>%
mutate(files=row_number()) %>%
mutate(files=ifelse(files==1,paste0("results/countries/",country,"-trend.svg"),paste0("results/countries/",country,"-change.svg")))
filenames <- read.xlsx("inclusions.xlsx") %>%
select(iso,country,strict_include) %>%
filter(strict_include==6) %>%
distinct() %>%
group_by(country) %>%
mutate(files=row_number()) %>%
mutate(files=ifelse(files==1,paste0("results/countries/",country,"-trend.svg"),paste0("results/countries/",country,"-change.svg")))
filenames <- read.xlsx("inclusions.xlsx") %>%
select(iso,country,strict_include) %>%
filter(strict_include==6) %>%
mutate(files=paste0("results/countries/",country,"-trend.svg"))
filenames <- read.xlsx("inclusions.xlsx") %>%
select(iso,country,strict_include) %>%
filter(strict_include==6) %>%
distinct() %>%
mutate(files=paste0("results/countries/",country,"-trend.svg"))
filenames <- filenames %>%
rbind(.,read.xlsx("inclusions.xlsx") %>%
select(iso,country,strict_include) %>%
filter(strict_include==6) %>%
distinct() %>%
mutate(files=paste0("results/countries/",country,"-change.svg")))
filenames <- filenames %>%
arrange(iso)
filenames <- filenames$files
svg_content <- readLines(file, warn = FALSE)
file=filenames[1]
svg_content <- readLines(file, warn = FALSE)
cat(svg_content)
library(maps)
## Get map data and clean up iso codes
map <- map_data("world") %>% filter(region!="Antarctica")
map <- map %>%
left_join(.,map %>%
select(region) %>%
distinct() %>%
mutate(iso=countrycode(region,"country.name","iso3c")),
by=join_by(region))
## Join inclusions
map <- map %>%
left_join(.,inclusions %>%
filter(strict_include==6) %>%
select(iso) %>%
distinct() %>%
mutate(include="yes"),
by=join_by(iso))
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= "#659cccff",na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = paste0(length(unique(inclusions$country[inclusions$strict_include==6])), " countries have reduced GHG emissions for more than 10 years"),caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
ggsave(paste0("results/map.png"), plot = p, device = "png", dpi = 300, width = 7, height = 4)
ggsave(paste0("results/map.pdf"), plot = p, device = cairo_pdf, width = 7, height = 4)
ggsave(paste0("results/map.svg"), plot = p, device = "svg", width = 7, height = 4)
p
View(inclusions)
blarg <- inclusions %>%
filter(var=="value_inLUC_10yr" & strict_include>=5)
View(blarg)
blarg <- inclusions %>%
filter(var=="value_inLUC_10yr" & strict_include>=5 & include==0)
## exceptions for countries with declining land sinks in the past 10 years?
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(var=="value_inLUC_10yr" & strict_include>=5 & include==0) %>%
mutate(less_strict_include=1) %>%
select(iso,less_strict_include))
## Include only countries with reductions in all three metrics
inclusions <- data_totals %>%
filter(!is.na(rate)) %>%
group_by(country,iso,var) %>%
summarise(rate=last(rate)) %>%
mutate(include=ifelse(rate<0,1,0))
## check if countries with earlier peak years also reduced in the past 10 years
rates <- data_totals %>% filter(country=="nothing")
for (i in 1:length(unique(data_totals$country))) {
temp_data <- data_totals %>% filter(country==unique(data_totals$country)[i])
temp_data <- temp_data %>%
group_by(var) %>%
filter(year>=max(data_totals$year)-9)
## Exclusions
temp_data <- temp_data %>%
filter(!is.na(value)) %>%
filter(include==0)
## Calculations
temp_data <- temp_data %>%
group_by(var) %>%
mutate(rate=growth_rate(year,value)$rate) %>%
mutate(fit=growth_rate(year,value)$data$predicted_x)
rates <- rbind(rates,temp_data)
}
rates <- rates %>%
select(country,iso,var,rate) %>%
distinct() %>%
mutate(include=ifelse(rate<0,1,0)) %>%
mutate(var=paste0(var,"_10yr"))
inclusions <- inclusions %>%
rbind(.,rates)
inclusions <- inclusions %>%
group_by(iso) %>%
mutate(strict_include=sum(include)) %>%
mutate(strict_include=ifelse(strict_include==6,"yes","no")) %>%
arrange(iso)
## exceptions for countries with declining land sinks in the past 10 years?
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(var=="value_inLUC_10yr" & strict_include>=5 & include==0) %>%
mutate(less_strict_include="yes") %>%
select(iso,less_strict_include))
length(unique(inclusions$country[inclusions$strict_include==6]))
write.xlsx(inclusions,"inclusions.xlsx")
inclusions <- data_totals %>%
filter(!is.na(rate)) %>%
group_by(country,iso,var) %>%
summarise(rate=last(rate)) %>%
mutate(include=ifelse(rate<0,1,0))
inclusions <- inclusions %>%
rbind(.,rates)
inclusions <- inclusions %>%
group_by(iso) %>%
mutate(strict_include=sum(include)) %>%
mutate(strict_include=ifelse(strict_include==6,"yes","no")) %>%
arrange(iso)
## exceptions for countries with declining land sinks in the past 10 years?
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(var=="value_inLUC_10yr" & strict_include>=5 & include==0) %>%
mutate(less_strict_include="yes") %>%
select(iso,less_strict_include)) %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include) & strict_include=="yes","yes","no"))
inclusions <- data_totals %>%
filter(!is.na(rate)) %>%
group_by(country,iso,var) %>%
summarise(rate=last(rate)) %>%
mutate(include=ifelse(rate<0,1,0))
inclusions <- inclusions %>%
rbind(.,rates)
inclusions <- inclusions %>%
group_by(iso) %>%
mutate(strict_include=sum(include)) %>%
mutate(strict_include=ifelse(strict_include==6,"yes","no")) %>%
arrange(iso)
## exceptions for countries with declining land sinks in the past 10 years?
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(var=="value_inLUC_10yr" & strict_include>=5 & include==0) %>%
mutate(less_strict_include="yes") %>%
select(iso,less_strict_include))# %>%
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include) & strict_include=="yes","yes","no"))
View(blarg)
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include) & strict_include=="yes","yes",less_strict_include))
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include) & strict_include=="yes","yes",less_strict_include)) %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include),"no",less_strict_include))
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include) & strict_include=="yes","yes",less_strict_include))# %>%
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include=="yes","yes",less_strict_include))
blarg <- inclusions %>% filter(strict_include>=5 & var=="value_inLUC_10yr" & include==0)
View(blarg)
inclusions <- data_totals %>%
filter(!is.na(rate)) %>%
group_by(country,iso,var) %>%
summarise(rate=last(rate)) %>%
mutate(include=ifelse(rate<0,1,0))
inclusions <- inclusions %>%
rbind(.,rates)
inclusions <- inclusions %>%
group_by(iso) %>%
mutate(strict_include=sum(include)) %>%
mutate(strict_include=ifelse(strict_include==6,"yes","no")) %>%
arrange(iso)
blarg <- inclusions %>% filter(strict_include>=5 & var=="value_inLUC_10yr" & include==0)
View(blarg)
blarg <- inclusions %>% filter(strict_include=="yes" & var=="value_inLUC_10yr" & include==0)
blarg <- inclusions %>% filter(strict_include=="yes" & var=="value_inLUC_10yr")
blarg <- inclusions %>% filter(var=="value_inLUC_10yr" & include==0)
inclusions <- data_totals %>%
filter(!is.na(rate)) %>%
group_by(country,iso,var) %>%
summarise(rate=last(rate)) %>%
mutate(include=ifelse(rate<0,1,0))
inclusions <- inclusions %>%
rbind(.,rates)
inclusions <- inclusions %>%
group_by(iso) %>%
mutate(strict_include=sum(include)) %>%
arrange(iso)
## exceptions for countries with declining land sinks in the past 10 years?
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(strict_include>=5 & var=="value_inLUC_10yr" & include==0) %>%
mutate(less_strict_include="yes") %>%
select(iso,less_strict_include))
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include=="yes","yes",less_strict_include))
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include==6,"yes",less_strict_include))
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include==6,"yes",less_strict_include)) %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include),"no",less_strict_include))
inclusions <- inclusions %>%
mutate(strict_include=ifelse(strict_include==6,"yes","no"))
length(unique(inclusions$country[inclusions$strict_include=="yes"]))
length(unique(inclusions$country[inclusions$less_strict_include=="yes"]))
inclusions <- data_totals %>%
filter(!is.na(rate)) %>%
group_by(country,iso,var) %>%
summarise(rate=last(rate)) %>%
mutate(include=ifelse(rate<0,1,0))
rates <- rates %>%
select(country,iso,var,rate) %>%
distinct() %>%
mutate(include=ifelse(rate<0,1,0)) %>%
mutate(var=paste0(var,"_10yr"))
inclusions <- inclusions %>%
rbind(.,rates)
inclusions <- inclusions %>%
group_by(iso) %>%
mutate(strict_include=sum(include)) %>%
arrange(iso)
## exceptions for countries with declining land sinks in the past 10 years?
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(strict_include>=5 & var=="value_inLUC_10yr" & include==0) %>%
mutate(less_strict_include="yes") %>%
select(iso,less_strict_include))
inclusions <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include==6,"yes",less_strict_include)) %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include),"no",less_strict_include))
inclusions <- inclusions %>%
mutate(strict_include=ifelse(strict_include==6,"yes","no"))
length(unique(inclusions$country[inclusions$strict_include=="yes"]))
length(unique(inclusions$country[inclusions$less_strict_include=="yes"]))
inclusions <- data_totals %>%
filter(!is.na(rate)) %>%
group_by(country,iso,var) %>%
summarise(rate=last(rate)) %>%
mutate(include=ifelse(rate<0,1,0))
## check if countries with earlier peak years also reduced in the past 10 years
rates <- data_totals %>% filter(country=="nothing")
for (i in 1:length(unique(data_totals$country))) {
temp_data <- data_totals %>% filter(country==unique(data_totals$country)[i])
temp_data <- temp_data %>%
group_by(var) %>%
filter(year>=max(data_totals$year)-9)
## Exclusions
temp_data <- temp_data %>%
filter(!is.na(value)) %>%
filter(include==0)
## Calculations
temp_data <- temp_data %>%
group_by(var) %>%
mutate(rate=growth_rate(year,value)$rate) %>%
mutate(fit=growth_rate(year,value)$data$predicted_x)
rates <- rbind(rates,temp_data)
}
rates <- rates %>%
select(country,iso,var,rate) %>%
distinct() %>%
mutate(include=ifelse(rate<0,1,0)) %>%
mutate(var=paste0(var,"_10yr"))
inclusions <- inclusions %>%
rbind(.,rates)
inclusions <- inclusions %>%
group_by(iso) %>%
mutate(strict_include=sum(include)) %>%
arrange(iso)
## exceptions for countries with declining land sinks in the past 10 years?
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(strict_include>=5 & var=="value_inLUC_10yr" & include==0) %>%
mutate(less_strict_include="yes") %>%
select(iso,less_strict_include))
## Make a less strict criteria with exceptions for countries with declining land sinks in the past 10 years
inclusions <- inclusions %>%
left_join(.,inclusions %>% filter(strict_include>=5 & var=="value_inLUC_10yr" & include==0) %>%
mutate(less_strict_include="yes") %>%
select(iso,less_strict_include))
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include==6,"yes",less_strict_include)) #
View(blarg)
blarg <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include==6,"yes",less_strict_include)) %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include)==TRUE,"no",less_strict_include))
inclusions <- inclusions %>%
mutate(less_strict_include=ifelse(strict_include==6,"yes",less_strict_include)) %>%
mutate(less_strict_include=ifelse(is.na(less_strict_include)==TRUE,"no",less_strict_include)) %>%
mutate(strict_include=ifelse(strict_include==6,"yes","no"))
inclusions <- inclusions %>%
select(iso,country,strict_include,less_strict_include) %>%
distinct()
View(inclusions)
length(inclusions$strict_include=="yes")
length(inclusions$country[inclusions$strict_include=="yes"])
length(inclusions$country[inclusions$less_strict_include=="yes"])
write.xlsx(inclusions,"inclusions.xlsx")
countries = data_totals %>%
filter(year==2022) %>%
filter(rate<0) %>%
select(country) %>%
distinct()
countries <- countries$country
i=1
data_totals$var <- as.factor(data_totals$var)
data_totals$var <- fct_relevel(data_totals$var,"value_exLUC","value_inLUC","value_co2cons")
year_higlight <- seq(1990, max(data_totals$year), by = 5)
if (!max(data_totals$year) %in% year_higlight) {
year_higlight <- c(year_higlight, max(data_totals$year))
}
plot_country_change("Germany",data_sectors)
countries <- unique(inclusions$country[inclusions$strict_include=="yes"])
countries <- unique(inclusions$country[inclusions$less_strict_include=="yes"])
for (i in 1:length(countries)){
plot <- plot_country_change(countries[i],data_sectors)
ggsave(plot,filename = paste0(countries[i],"-change.png"),
path = "results/countries/",device = "png",height = 4,width=8,dpi=300)
ggsave(plot,filename = paste0(countries[i],"-change.pdf"),
path = "results/countries/",device = cairo_pdf,height = 4,width=8)
ggsave(plot,filename = paste0(countries[i],"-change.svg"),
path = "results/countries/",device = 'svg',height = 4,width=8)
}
## Save data
wb <- createWorkbook()
addWorksheet(wb,"info")
addWorksheet(wb,"data")
info = data.frame(a=c("Author","Contact","Data sources","See also"),
b=c("William F. Lamb",
"william.lamb@pik-potsdam.de",
"Tidy GHG Inventories (https://zenodo.org/records/14637347)",
"https://lambwf.github.io/Countries-that-reached-peak-emissions"))
writeData(wb, sheet = "info",info,colNames = F, rowNames = F)
writeData(wb, sheet = "data",data_sectors %>%
arrange(country,iso,sector_tidy_order,year) %>%
select(country,iso,sector_tidy,year,value,change_abs,change_rel) %>%
mutate(units="MtCO2e (GWP100 AR6)"),colNames = T, rowNames = F)
saveWorkbook(wb,paste0("results/Countries-peak-emissions-change.xlsx"),overwrite=T)
map <- map_data("world") %>% filter(region!="Antarctica")
map <- map %>%
left_join(.,map %>%
select(region) %>%
distinct() %>%
mutate(iso=countrycode(region,"country.name","iso3c")),
by=join_by(region))
## Join inclusions
map <- map %>%
left_join(.,inclusions %>%
filter(strict_include=="yes") %>%
select(iso,strict_include),
by=join_by(iso))
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= "#659cccff",na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = paste0(length(unique(inclusions$country[inclusions$strict_include==6])), " countries have reduced GHG emissions for more than 10 years"),caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= "#659cccff",na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = paste0(length(inclusions$country[inclusions$strict_include=="yes"]), " countries have reduced GHG emissions for more than 10 years"),caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= "#659cccff",na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = paste0(length(inclusions$country[inclusions$strict_include=="yes"]), " countries have reduced GHG emissions for more than 10 years"),caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= "#659cccff",na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = "Countries that have reduced GHG emissions for more than 10 years",
caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
map <- map_data("world") %>% filter(region!="Antarctica")
map <- map %>%
left_join(.,map %>%
select(region) %>%
distinct() %>%
mutate(iso=countrycode(region,"country.name","iso3c")),
by=join_by(region))
## Join inclusions
map <- map %>%
left_join(.,inclusions %>%
gather(.,include,value,strict_include,less_strict_include),
by=join_by(iso))
View(map)
blarg <- inclusions %>%
gather(.,include,value,strict_include,less_strict_include)
View(blarg)
map <- map_data("world") %>% filter(region!="Antarctica")
map <- map %>%
left_join(.,map %>%
select(region) %>%
distinct() %>%
mutate(iso=countrycode(region,"country.name","iso3c")),
by=join_by(region))
## Join inclusions
map <- map %>%
left_join(.,inclusions,by=join_by(iso))
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= "#659cccff",na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = "Countries that have reduced GHG emissions for more than 10 years",
caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
View(map)
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= c("#659cccff",'#939393'),na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = "Countries that have reduced GHG emissions for more than 10 years",
caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= c('#939393',"#659cccff"),na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = "Countries that have reduced GHG emissions for more than 10 years",
caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=less_strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= c('#939393',"#659cccff"),na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = "Countries that have reduced GHG emissions for more than 10 years",
caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=less_strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= c('#939393',"#659cccff"),na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = paste0(length(inclusions$country[inclusions$less_strict_include=="yes"]), " countries that have reduced GHG emissions for more than 10 years"),
caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
p <- ggplot() +
geom_polygon(data = map, aes(x=long, y = lat, group=group, fill=less_strict_include),color="white",size=0.2,na.rm=T) +
#coord_fixed(1,xlim=c(-120,70),ylim=c(0,70)) +
scale_fill_manual(values= c('#939393',"#659cccff"),na.value='#939393') +
theme_wl_empty() +
theme(legend.position="none",
panel.border = element_rect(colour = "#636363",fill=NA)) +
labs(subtitle = paste0(length(inclusions$country[inclusions$less_strict_include=="yes"]), " countries have reduced GHG emissions for more than 10 years"),
caption = "⌂ Data: UNFCCC, Tidy GHG inventories, GCB 2024   ⌂ CC-BY William F. Lamb")
p
ggsave(paste0("results/map.png"), plot = p, device = "png", dpi = 300, width = 7, height = 4)
ggsave(paste0("results/map.pdf"), plot = p, device = cairo_pdf, width = 7, height = 4)
ggsave(paste0("results/map.svg"), plot = p, device = "svg", width = 7, height = 4)
filenames <- read.xlsx("inclusions.xlsx") %>%
filter(less_strict_include=="yes") %>%
distinct() %>%
mutate(files=paste0("results/countries/",country,"-trend.svg"))
View(filenames)
filenames <- filenames %>%
rbind(.,read.xlsx("inclusions.xlsx") %>%
filter(less_strict_include=="yes") %>%
distinct() %>%
mutate(files=paste0("results/countries/",country,"-change.svg")))
filenames <- filenames %>%
arrange(iso)
filenames <- filenames$files
